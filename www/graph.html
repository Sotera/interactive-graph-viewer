<style>
    #graph2 {
        top: 0;
        bottom: 0;
        left: 0;
        right: 0;
        position: absolute;
    }
</style>

<div id="graph2"></div>

<script>
    sigma.parsers.json("data/current_graph.json",

        {
            container: 'graph2'
        },

        function(s) { //This function is passed an instance of Sigma s

            // Initial node config, random (x,y) 
            s.graph.nodes().forEach(function(node, i, a) {
                //node.x = Math.random() * 10;
                //node.y = Math.random() * 10;
                switch (node.type) {
                    case "Chemical":
                        node.color = "#FF8800";
                        node.originalColor = "#FF8800";
                        break;

                    case "Disease":
                        node.color = "#CC0000";
                        node.originalColor = "#CC0000";;
                        break;

                    case "Protein":
                        node.color = "#77B300";
                        node.originalColor = "#77B300";
                        break;

                    case "Community":
                        node.color = "#2A9FD6";
                        node.originalColor = "#2A9FD6";
                        break;

                    default:
                        break;
                }
            });

            //Call refresh to render the new graph
            s.refresh();

            // Finally, turn on force atlas 2
           s.startForceAtlas2({
                startingIterations: 150,
                iterationsPerRender: 50,
                barnesHutOptimize: false,
                adjustSizes: true,
                worker: true,
                strongGravityMode: true,
                lingLogMode: true
            });

            function stop() {
                s.killForceAtlas2();
            }

            window.setTimeout(stop, 2000);
            s.refresh();
            

            // action if we click on a node
            s.bind('clickNode', function(e) {
                window.console.log(e.type, e.data.node.label, e.data.captor);
                Shiny.onInputChange("comm_id", e.data.node.label);
            });

            // action if we click on the background 
            //s.bind('clickStage', function(e)){
            //    Shiny.onInputChange("comm_id", null)
            //}


        });
</script>